/*
 * Binary Ajax 0.1.10
 * Copyright (c) 2008 Jacob Seidelin, jseidelin@nihilogic.dk, http://blog.nihilogic.dk/
 * Licensed under the MPL License [http://www.nihilogic.dk/licenses/mpl-license.txt]
 */
var BinaryFile=function(h,k,g){var e=h,f=k||0,d=0;this.getRawData=function(){return e};"string"==typeof h?(d=g||e.length,this.getByteAt=function(b){return e.charCodeAt(b+f)&255},this.getBytesAt=function(b,c){for(var a=[],d=0;d<c;d++)a[d]=e.charCodeAt(b+d+f)&255;return a}):"unknown"==typeof h&&(d=g||IEBinary_getLength(e),this.getByteAt=function(b){return IEBinary_getByteAt(e,b+f)},this.getBytesAt=function(b,c){return(new VBArray(IEBinary_getBytesAt(e,b+f,c))).toArray()});this.getLength=function(){return d};
this.getSByteAt=function(b){b=this.getByteAt(b);return 127<b?b-256:b};this.getShortAt=function(b,c){var a=c?(this.getByteAt(b)<<8)+this.getByteAt(b+1):(this.getByteAt(b+1)<<8)+this.getByteAt(b);0>a&&(a+=65536);return a};this.getSShortAt=function(b,c){var a=this.getShortAt(b,c);return 32767<a?a-65536:a};this.getLongAt=function(b,c){var a=this.getByteAt(b),d=this.getByteAt(b+1),j=this.getByteAt(b+2),e=this.getByteAt(b+3),a=c?(((a<<8)+d<<8)+j<<8)+e:(((e<<8)+j<<8)+d<<8)+a;0>a&&(a+=4294967296);return a};
this.getSLongAt=function(b,c){var a=this.getLongAt(b,c);return 2147483647<a?a-4294967296:a};this.getStringAt=function(b,c){for(var a=[],d=this.getBytesAt(b,c),e=0;e<c;e++)a[e]=String.fromCharCode(d[e]);return a.join("")};this.getCharAt=function(b){return String.fromCharCode(this.getByteAt(b))};this.toBase64=function(){return window.btoa(e)};this.fromBase64=function(b){e=window.atob(b)}},BinaryAjax=function(){function h(){var g=null;window.ActiveXObject?g=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest&&
(g=new XMLHttpRequest);return g}function k(g,e,f,d,b,c){var a=h();if(a){var l=0;d&&!b&&(l=d[0]);var j=0;d&&(j=d[1]-d[0]+1);e&&("undefined"!=typeof a.onload?a.onload=function(){"200"==a.status||"206"==a.status||"0"==a.status?(a.binaryResponse=new BinaryFile(a.responseText,l,j),a.fileSize=c||a.getResponseHeader("Content-Length"),e(a)):f&&f();a=null}:a.onreadystatechange=function(){if(4==a.readyState){if("200"==a.status||"206"==a.status||"0"==a.status){var b={status:a.status,binaryResponse:new BinaryFile("unknown"==
typeof a.responseBody?a.responseBody:a.responseText,l,j),fileSize:c||a.getResponseHeader("Content-Length")};e(b)}else f&&f();a=null}});a.open("GET",g,!0);a.overrideMimeType&&a.overrideMimeType("text/plain; charset=x-user-defined");d&&b&&a.setRequestHeader("Range","bytes="+d[0]+"-"+d[1]);a.setRequestHeader("If-Modified-Since","Sat, 1 Jan 1970 00:00:00 GMT");a.send(null)}else f&&f()}return function(g,e,f,d){if(d){var b=function(a){var b=parseInt(a.getResponseHeader("Content-Length"),10);a=a.getResponseHeader("Accept-Ranges");
var c;c=d[0];0>d[0]&&(c+=b);k(g,e,f,[c,c+d[1]-1],"bytes"==a,b)},c=h();c&&(b&&("undefined"!=typeof c.onload?c.onload=function(){"200"==c.status&&b(this);c=null}:c.onreadystatechange=function(){4==c.readyState&&("200"==c.status&&b(this),c=null)}),c.open("HEAD",g,!0),c.send(null))}else k(g,e,f)}}();document.write("<script type='text/vbscript'>\r\nFunction IEBinary_getByteAt(strBinary, iOffset)\r\n\tIEBinary_getByteAt = AscB(MidB(strBinary, iOffset + 1, 1))\r\nEnd Function\r\nFunction IEBinary_getBytesAt(strBinary, iOffset, iLength)\r\n  Dim aBytes()\r\n  ReDim aBytes(iLength - 1)\r\n  For i = 0 To iLength - 1\r\n   aBytes(i) = IEBinary_getByteAt(strBinary, iOffset + i)\r\n  Next\r\n  IEBinary_getBytesAt = aBytes\r\nEnd Function\r\nFunction IEBinary_getLength(strBinary)\r\n\tIEBinary_getLength = LenB(strBinary)\r\nEnd Function\r\n\x3c/script>\r\n");